CREATE OR REPLACE VIEW iv_global_view FOLDER = '/2 - integration'
    PRIMARY KEY ( 'id' ) AS SELECT rownum() AS id, bv_entreprise.sal_mat_paie AS sal_mat_paie, bv_entreprise.sal_empli AS sal_empli, bv_entreprise.date_ent AS date_ent, bv_entreprise.date_fin AS date_fin, bv_entreprise.sal_motifsot AS sal_motifsot, bv_entreprise.sal_motif_ent AS sal_motif_ent, bv_entreprise.type_contrat AS type_contrat, bv_entreprise.sal_danc AS sal_danc, bv_entreprise.sal_catsoc AS sal_catsoc, bv_entreprise.sal_hmens AS sal_hmens, bv_entreprise.sal_qualif_referentiel AS sal_qualif_referentiel, bv_entreprise.num_rtablissement AS num_rtablissement, bv_employees.sal_empl AS sal_empl, bv_employees.full_name AS full_name, to_timestamp('MM/dd/yyyy', bv_employees.date_nais) AS date_nais, bv_employees.ind_sexe AS ind_sexe, bv_employees.mail AS mail, bv_employees.nb_enf AS nb_enf, bv_employees.age AS age, iv_etablissement.code_etabl AS code_etabl, iv_etablissement.nom_etabl AS nom_etabl, iv_etablissement.code_paye AS code_paye, bv_etablissement_payes.id_paye AS id_paye, bv_etablissement_payes.nom_payé AS nom_payé, bv_etablissement_motif_sort.code_motif_sort AS code_motif_sort, bv_etablissement_motif_sort.desc_motif_sort AS desc_motif_sort, bv_qualif_eng.qualif_fr AS qualif_fr, bv_qualif_eng.qualif_en AS qualif_en, case WHEN (bv_entreprise.sal_hmens > 152) THEN 'Full-time' ELSE 'Part-time' END AS type_regime, case WHEN (bv_entreprise.sal_hmens > 152) THEN 1 ELSE 2 END AS id_type_regime FROM (((bv_entreprise AS bv_entreprise INNER JOIN bv_employees AS bv_employees ON bv_entreprise.sal_empli = bv_employees.sal_empl ) INNER JOIN (iv_etablissement AS iv_etablissement INNER JOIN bv_etablissement_payes AS bv_etablissement_payes ON iv_etablissement.code_paye = bv_etablissement_payes.id_paye ) ON bv_entreprise.num_rtablissement = iv_etablissement.code_etabl ) INNER JOIN bv_etablissement_motif_sort AS bv_etablissement_motif_sort ON bv_entreprise.sal_motifsot = bv_etablissement_motif_sort.code_motif_sort ) INNER JOIN bv_qualif_eng AS bv_qualif_eng ON bv_entreprise.sal_qualif_referentiel = bv_qualif_eng.qualif_fr ;

ALTER VIEW iv_global_view
 LAYOUT (bv_entreprise = [23, 4, 200, 200], bv_employees = [619, 5, 200, 200], iv_etablissement = [492, 109, 200, 200], bv_etablissement_payes = [774, 107, 200, 200], bv_etablissement_motif_sort = [396, 190, 200, 200], bv_qualif_eng = [293, 271, 200, 200]);

